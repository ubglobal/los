# ==============================================================================
# UPLOADS DIRECTORY - DENY ALL DIRECT ACCESS
# ==============================================================================
#
# Security Enhancement: All downloads must go through download_document.php
# This enforces access control and prevents unauthorized file access
#
# Updated: 2025-10-30
# ==============================================================================

# DENY ALL DIRECT ACCESS - Forces downloads through download_document.php
Order Deny,Allow
Deny from all

# Prevent PHP execution in uploads directory (defense in depth)
php_flag engine off

# Disable directory listing
Options -Indexes

# Prevent execution of any script files
<FilesMatch "\.(ph(p[3-7]?|tml)|pl|py|jsp|asp|sh|cgi)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# NOTE: All file downloads are now handled by download_document.php
# which enforces proper access control based on user permissions
